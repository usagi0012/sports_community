<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>동아리 생성</title>
    </head>
    <body>
        <div class="modal-content">
            <label for="name">이름:</label>
            <input type="text" id="name" />
            <br />
            <label for="location">지역:</label>
            <select id="location">
                <option value="0">서울</option>
                <option value="1">부산</option>
                <option value="2">대구</option>
                <option value="3">인천</option>
                <option value="4">광주</option>
                <option value="5">대전</option>
                <option value="6">울산</option>
                <option value="7">세종</option>
                <option value="8">경기</option>
                <option value="9">강원</option>
                <option value="10">충청북도</option>
                <option value="11">충청남도</option>
                <option value="12">경상북도</option>
                <option value="13">경상남도</option>
                <option value="14">전라북도</option>
                <option value="15">전라남도</option>
                <option value="16">제주도</option>
            </select>
            <br />
            <label for="description">설명:</label>
            <textarea id="description"></textarea>
            <br />
            <input type="file" id="fileInput" />
            <br />
            <button onclick="submitForm()">제출</button>
            <button onclick="closeModal()">닫기</button>
        </div>
        <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
        <script type="module" src="./js/create-club.js"></script>
        <script>
            function submitForm() {
                const name = document.getElementById("name").value;
                const region = document.getElementById("location").value;
                const description =
                    document.getElementById("description").value;
                const file = document.getElementById("fileInput").files[0];

                const authorized = localStorage.getItem("authorized");
                const token = JSON.parse(authorized).accessToken.value;
                axios
                    .post(
                        "/api/club",
                        {
                            name: name,
                            region: region,
                            description: description,
                        },
                        {
                            headers: {
                                Authorization: `Bearer ${token}`,
                            },
                        },
                    )
                    .then(function (response) {
                        console.log(response);
                        //폼 제출 후 원래 페이지로 이동
                        returnPage();
                    })
                    .catch(function (error) {
                        console.log(error.response);
                        alert("동아리를 등록할 수 없습니다.");
                    });
            }
            function returnPage() {
                console.log("페이지 이동");
                window.location.href = `http://localhost:8001/club.html`;
            }
        </script>
    </body>
</html>
